import{r as l,k as S,j as e,L as C,ah as k,ai as E,aj as R,M as L,ak as F,B as r}from"./index-B5pvZNP2.js";const P=()=>{const[x,n]=l.useState([]),[m,h]=l.useState(!0),[o,f]=l.useState(""),[j,d]=l.useState(!1),[p,N]=l.useState(null),[i,u]=l.useState(""),c=S();l.useEffect(()=>{(async()=>{try{const a=(await c.get("/user")).data;n(a),h(!1)}catch(t){console.error("Error fetching Users:",t),h(!1)}})()},[c]);const y=async s=>{try{await c.delete(`/user/${s}`),n(x.filter(t=>t._id!==s)),r.success("User deleted successfully!",{autoClose:3e3})}catch(t){r.error("Failed to delete the user.",{autoClose:3e3}),console.error("Error deleting user:",t)}},g=async()=>{try{(await c.put("/user",{email:p.email,role:i})).data.message==="Profile updated successfully"?(r.success("User role updated successfully!"),n(t=>t.map(a=>a.email===p.email?{...a,role:i}:a))):r.error("Failed to update role.")}catch(s){console.error("Error updating role:",s),r.error("Error updating role.")}finally{d(!1)}},b=s=>{N(s),u(s.role||"user"),d(!0)},w=x.filter(s=>{const t=s.name?s.name.toLowerCase():"",a=s.userId?s.userId.toString():"",U=s.role?s.role.toLowerCase():"";return t.includes(o.toLowerCase())||a.includes(o)||U.includes(o.toLowerCase())});function v(s){switch(s){case"admin":return"blue";case"moderator":return"navy";case"user":return"red";default:return"red"}}return m?e.jsx(C,{}):e.jsxs("section",{className:"container mx-auto px-[0.5rem] py-6 text-sm",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute left-3 top-3 text-gray-400",children:e.jsx(k,{})}),e.jsx("input",{type:"text",placeholder:"Search users by name, role or userId",className:"border p-2 pl-10 pr-10 rounded-full w-full border-slate-300",value:o,onChange:s=>f(s.target.value)}),e.jsxs("div",{className:"absolute right-3 top-3 flex items-center text-sm text-gray-400",children:[e.jsx(E,{className:"mr-1"}),e.jsx(R,{})]})]}),e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"table-auto w-full text-left whitespace-no-wrap",children:[e.jsx("thead",{className:"bg-slate-100 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2",children:"User Id"}),e.jsx("th",{className:"px-3 py-2",children:"Photo"}),e.jsx("th",{className:"px-3 py-2",children:"Name"}),e.jsx("th",{className:"px-3 py-2",children:"Email"}),e.jsx("th",{className:"px-3 py-2",children:"Phone"}),e.jsx("th",{className:"px-3 py-2",children:"Joined"}),e.jsx("th",{className:"px-3 py-2",children:"Location"}),e.jsx("th",{className:"px-3 py-2",children:"Role"}),e.jsx("th",{className:"px-3 py-2",children:"Update"}),e.jsx("th",{className:"px-3 py-2",children:"Delete"})]})}),e.jsx("tbody",{children:w.map((s,t)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-3 py-3 flex items-center",children:[t+1,"."," ",e.jsxs("span",{className:"font-semibold",children:["#",s.userId]})]}),e.jsx("td",{className:"p-3",children:e.jsx("img",{src:s.photo,alt:s.name,className:"w-10 h-10 rounded-full"})}),e.jsx("td",{className:"p-3",children:s.name}),e.jsx("td",{className:"p-3",children:s.email}),e.jsx("td",{className:"p-3",children:s.phone}),e.jsx("td",{className:"p-3",children:s.joined}),e.jsxs("td",{className:"p-3",children:[s.city,", ",s.country]}),e.jsx("td",{className:"p-3",style:{color:v(s.role)},children:s.role||"user"}),e.jsx("td",{className:"px-4 py-2 text-start",children:e.jsx("button",{className:"bg-slate-100 hover:bg-[#1e1d29] hover:text-white transition-all shadow-md p-3.5 rounded-full flex items-center justify-center",onClick:()=>b(s),children:e.jsx(L,{})})}),e.jsx("td",{className:"px-3 py-3 flex justify-end",children:e.jsx("button",{className:"bg-[#ff5a00] hover:bg-orange-600 transition-all text-white font-bold shadow-md p-3.5 rounded-full flex items-center justify-center",onClick:()=>y(s._id),children:e.jsx(F,{})})})]},t))})]})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-md shadow-md w-80",children:[e.jsx("h2",{className:"text-lg font-serif font-bold mb-4",children:"Update Role"}),e.jsxs("select",{value:i,onChange:s=>u(s.target.value),className:"w-full p-2 border rounded-full",children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"blocked",children:"Blocked"})]}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx("button",{className:"px-7 py-2 bg-[#1e1f29] rounded-full text-white",onClick:()=>d(!1),children:"Cancel"}),e.jsx("button",{className:"px-6 py-2 bg-[#ff5a00] text-white rounded-full hover:bg-orange-600",onClick:g,children:"Update"})]})]})})]})};export{P as default};
